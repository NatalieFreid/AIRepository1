
# GitHub Copilot Instructions for D365FO (Metadata XML)

> **Purpose**: Steer GitHub Copilot to generate **D365FO AOT metadata XML** files (not X++ snippets) for core code objects. Use this as `copilot-instructions.md` or place it at `.github/copilot-instructions.md` in your repo.

This guide provides:
- Authoring guidance for **AOT XML** (Tables, EDTs, Enums, Classes)
- **Complete XML examples** you can adapt
- Ready-to-paste **prompt templates**

> **Note**: These are simplified, human-readable XML templates compatible with typical D365FO/AOS metadata conventions. Real projects may have additional elements/attributes generated by the designer.

---

## ‚úÖ General Guidance for Copilot (XML)

- Use a **single root** element named after the artifact type (e.g., `AxTable`, `AxEdt`, `AxEnum`, `AxClass`).
- Always include **Name**, **Label**, and optional **HelpText**.
- Use **EDT** names when defining field types (for tables) and set **indexes** and **relations** explicitly.
- For classes, include **Name/Label** in metadata; method bodies are typically stored as X++ source, but you can embed simplified `<Source>` blocks when needed to keep everything in one file.
- Do **not** declare system fields (`RecId`, `DataAreaId`, `RecVersion`)‚Äîthey are system-managed.

---

## üì¶ Example: Table XML (`AxTable`)

```xml
<?xml version="1.0" encoding="utf-8"?>
<AxTable xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	<Name>AVADemoTable</Name>
	<SourceCode>
		<Declaration><![CDATA[
public class AVADemoTable extends common
{
}
]]></Declaration>
		<Methods>
			<Method>
				<Name>shouldThrowExceptionOnZeroDelete</Name>
				<Source><![CDATA[
    /// <summary>
    /// Determines if concurrent deletes should throw exception.
    /// </summary>
    /// <returns>true, if exception should be thrown; otherwise, false.</returns>
    public boolean shouldThrowExceptionOnZeroDelete()
    {
        return true;
    }

]]></Source>
			</Method>
		</Methods>
	</SourceCode>
	<SubscriberAccessLevel>
		<Read>Allow</Read>
	</SubscriberAccessLevel>
	<AllowRowVersionChangeTracking>Yes</AllowRowVersionChangeTracking>
	<DeleteActions />
	<FieldGroups>
		<AxTableFieldGroup>
			<Name>AutoReport</Name>
			<Fields />
		</AxTableFieldGroup>
		<AxTableFieldGroup>
			<Name>AutoLookup</Name>
			<Fields />
		</AxTableFieldGroup>
		<AxTableFieldGroup>
			<Name>AutoIdentification</Name>
			<AutoPopulate>Yes</AutoPopulate>
			<Fields />
		</AxTableFieldGroup>
		<AxTableFieldGroup>
			<Name>AutoSummary</Name>
			<Fields />
		</AxTableFieldGroup>
		<AxTableFieldGroup>
			<Name>AutoBrowse</Name>
			<Fields />
		</AxTableFieldGroup>
		<AxTableFieldGroup>
			<Name>Overview</Name>
			<Label>@SYS9039</Label>
			<Fields>
				<AxTableFieldGroupField>
					<DataField>CustGroupId</DataField>
				</AxTableFieldGroupField>
				<AxTableFieldGroupField>
					<DataField>Name</DataField>
				</AxTableFieldGroupField>
			</Fields>
		</AxTableFieldGroup>
	</FieldGroups>
	<Fields>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>CustGroupId</Name>
			<ExtendedDataType>CustGroupId</ExtendedDataType>
			<IgnoreEDTRelation>Yes</IgnoreEDTRelation>
		</AxTableField>
		<AxTableField xmlns=""
			i:type="AxTableFieldString">
			<Name>Name</Name>
			<ExtendedDataType>Name</ExtendedDataType>
			<IgnoreEDTRelation>Yes</IgnoreEDTRelation>
		</AxTableField>
	</Fields>
	<FullTextIndexes />
	<Indexes>
		<AxTableIndex>
			<Name>GroupIdx</Name>
			<AllowDuplicates>Yes</AllowDuplicates>
			<Fields>
				<AxTableIndexField>
					<DataField>CustGroupId</DataField>
				</AxTableIndexField>
			</Fields>
		</AxTableIndex>
	</Indexes>
	<Mappings />
	<Relations />
	<StateMachines />
</AxTable>```

---

## üî§ Example: EDT XML (`AxEdt`)

```xml
<AxEdt>
  <Name>DemoId</Name>
  <Label>@Demo:DemoId</Label>
  <HelpText>@Demo:DemoIdHelp</HelpText>
  <Type>String</Type>
  <StringSize>20</StringSize>
  <Alignment>Left</Alignment>
  <DisplayLength>20</DisplayLength>
</AxEdt>
```

---

## üßÆ Example: Enum XML (`AxEnum`)

```xml
<?xml version="1.0" encoding="utf-8"?>
<AxEdt xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns=""
	i:type="AxEdtString">
	<Name>AccountNumber</Name>
	<Label>@SYS24500</Label>
	<ArrayElements />
	<Relations />
	<TableReferences />
	<StringSize>30</StringSize>
</AxEdt>
```

---

## üß† Example: Class XML (`AxClass`)

> In D365FO, the class **metadata** is stored in XML (name, labels, properties), while the **X++ source** is stored as code. If you want everything in a single file for scaffolding, include a `<Source>` element for illustrative purposes.

```xml
<?xml version="1.0" encoding="utf-8"?>
<AxClass xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	<Name>AVADemoClass</Name>
	<SourceCode>
		<Declaration><![CDATA[
internal final class AVADemoClass
{
}
]]></Declaration>
		<Methods>
			<Method>
				<Name>main</Name>
				<Source><![CDATA[
    public static void main(Args _args)
    {
        AVADemoClass demo = new AVADemoClass();
    }

]]></Source>
			</Method>
			<Method>
				<Name>run</Name>
				<Source><![CDATA[
    public void run()
    {
        info("Hello, this is a demo class for Azure Virtual Agents integration!");
    }

]]></Source>
			</Method>
		</Methods>
	</SourceCode>
</AxClass>
```

---

## üß© Optional: Form/Data Entity XML Pointers

- **Forms** often reference `AxForm` with DataSources and Design controls‚Äîthese are verbose. Start simple: Name/Label, one DataSource, and a Grid control bound to your `AxTable` fields.
- **Data entities** (`AxDataEntity`) define data sources and staging; include Name, Label, and a list of fields mapping to your table.

---

## üß≠ Prompt Templates for Copilot

Use these to ask Copilot for XML directly:

- **Table**
  > "Generate a D365FO **AxTable XML** named `DemoEntity` with fields `DemoId` (EDT), `Name`, `ItemId`, `Qty`, `Status` (enum `DemoStatus`), a primary/cluster index on `DemoId`, an alternate key on `Name`, a relation to `InventTable` on `ItemId`, and field groups `AutoLookup`/`AutoReport`."

- **EDT**
  > "Create an **AxEdt XML** for `DemoId` (string size 20, left aligned) with label/help."

- **Enum**
  > "Create an **AxEnum XML** named `DemoStatus` with elements `None=0`, `Active=1`, `Closed=2` and labels."

- **Class**
  > "Produce an **AxClass XML** for `DemoEntityService` (RunOn=Server, IsFinal=Yes) and embed a `<Source>` block with a static method `findByDemoId(DemoId)` that selects by `DemoId`."

---

## üîç Quality Checklist (XML)

- Root element corresponds to artifact type (`AxTable`, `AxEdt`, `AxEnum`, `AxClass`).
- Includes **Name** and **Label**; optional **HelpText** is descriptive.
- For tables: fields use **EDT** names; indexes declare uniqueness; relations reference existing tables.
- XML is **well-formed** (matching tags, valid nesting, CDATA for any embedded code).
- Avoid system-managed fields in table XML.

---

## ‚ÑπÔ∏è Notes

- These examples are intentionally concise to be readable in code reviews and PRs.
- When importing to Visual Studio, the designer may expand with additional metadata.
- Align **label IDs** (e.g., `@Demo:...`) with your solution's label file prefix.

